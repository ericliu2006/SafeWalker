<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeWalker Website</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" integrity="sha384-HzLeBuhoNPvSl5KYnjx0BT+WB0QEEqLprO+NBkkk5gbc67FTaL7XIGa2w1L0Xbgc" crossorigin="anonymous"/>
    <link href="https://fonts.googleapis.com/css2?family=Kumbh+Sans:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&libraries=places&callback=initMap" async defer></script>
    <style>
        /* Map will now stretch to fill the service card */
        #map {
            height: 100%;
            width: 100%;
        }

        /* Container for the destination input */
        .destination-container {
            display: flex;
            align-items: center;
            justify-content: flex-start;
        }

        /* Input field */
        #destination {
            flex-grow: 1;
            padding: 8px;
            font-size: 14px;
            margin-right: 10px;
        }

        /* Submit button next to the input field */
        button {
            padding: 8px 16px;
            font-size: 14px;
        }

        /* Instructions spacing */
        #instructions {
            margin-top: 20px;
            font-size: 18px;
        }

        /* Flexbox for the services section */
        .services__container {
            display: flex;
            justify-content: space-between;
            height: 400px;
        }

        .services__card {
            flex: 1;
            margin: 0 10px;
            position: relative;
        }

        /* Footer content alignment */
        .footer__logo, .website__right {
            display: inline-block;
        }

        /* Center the label (h2) above the input */
        .services__card h2 {
            text-align: left;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="navbar__container">
            <a href="#" id="navbar__logo">
                <i class="fas fa-gem"></i>SafeWalker
            </a>
            <div class="navbar__toggle" id="mobile-menu">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
            <ul class="navbar__menu">
                <li class="navbar__item">
                    <a href="#" class="navbar__links">Home</a>
                </li>
                <li class="navbar__item">
                    <a href="#explore" class="navbar__links" onclick="scrollToExplore()">Technology</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="main">
        <div class="main__container">
            <div class="main__content">
                <img src="SafeWalkerLogo.png" alt="SafeWalker Logo" style="max-width: 200px; margin-bottom: 20px;">
                <h1>NEXT GENERATION</h1>
                <h2>TECHNOLOGY</h2>
                <p>See what makes us different.</p>
                <a href="#explore" class="main_btn" onclick="scrollToExplore()">Get Started</a>
            </div>
            <div class="main__img--container">
                <img src="Carsimg.png" alt="pic" id="main__img" />
            </div>
        </div>
    </div>

    <!-- Service Section -->
    <div class="services" id="explore">
        <h1>Use SafeWalker</h1>
        <div class="services__container">
            <div class="services__card">
                <h2>Enter Your Destination</h2>
                <form id="destinationForm" action="/destination" method="POST"> <!-- Add id to form -->
                    <div class="destination-container">
                        <input type="text" id="destination" name="destination" placeholder="Enter Destination" required>
                        <button type="submit">Submit</button>
                    </div>
                </form>
                <div id="instructions"></div>
            </div>
            <div class="services__card">
                <div id="map"></div>
            </div>
        </div>
    </div>

    <div class="footer__container">
        <div class="footer__links">
            <div class="footer__link--wrapper">
                <div class="footer__link--items">
                    <h2>About Us</h2>
                    <p>Eric Liu: <a href="mailto:eyl17@pitt.edu">eyl17@pitt.edu</a></p>
                </div>
                <div class="footer__link--items">
                    <h2>&nbsp;</h2>
                    <p>Thomas Tran: <a href="mailto:tdt17@pitt.edu">tdt17@pitt.edu</a></p>
                </div>
                <div class="footer__link--items">
                    <h2>&nbsp;</h2>
                    <p>Lokesh Daita: <a href="mailto:lod42@pitt.edu">lod42@pitt.edu</a></p>
                </div>
                <div class="footer__link--items">
                    <h2>&nbsp;</h2>
                    <p>Abhinav Nath: <a href="mailto:abn52@pitt.edu">abn52@pitt.edu</a></p>
                </div>
            </div>
        </div>

        <div class="social__media">
            <div class="social__media--wrap">
                <div class="footer__logo" style="text-align: right;">
                    <a href="#" id="footer__logo">
                        <i class="fas fa-gem"></i>SafeWalker
                    </a>
                </div>
                <p class="website__right" style="text-align: right;">SafeWalker 2024</p>
            </div>
        </div>
    </div>

    <script>
        let map, directionsService, directionsRenderer, autocomplete;

        function initMap() {
            directionsService = new google.maps.DirectionsService();
            directionsRenderer = new google.maps.DirectionsRenderer();

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    const userLocation = { lat: position.coords.latitude, lng: position.coords.longitude };

                    map = new google.maps.Map(document.getElementById('map'), {
                        zoom: 14,
                        center: userLocation
                    });

                    directionsRenderer.setMap(map);
                    const input = document.getElementById('destination');
                    autocomplete = new google.maps.places.Autocomplete(input);
                });
            }
        }

        document.getElementById('destinationForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const destination = document.getElementById('destination').value;

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const originLat = position.coords.latitude;
                    const originLng = position.coords.longitude;

                    const formData = new FormData();
                    formData.append('destination', destination);
                    formData.append('origin_lat', originLat);
                    formData.append('origin_lng', originLng);

                    fetch('/destination', {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        // Display the message or error from the server
                        document.getElementById('instructions').innerText = data.message || data.error;
                    })
                    .catch(error => console.error('Error:', error));
                });
            }
        });
    </script>
</body>
</html>
